document.addEventListener('DOMContentLoaded', (event) => {
    const questions = [
        {
            question: "What does the term 'malware' stand for?",
            options: ["Malicious Worm", "Malicious Software", "Malfunctioning System", "Malwarebytes"],
            answer: "Malicious Software"
        },
        {
            question: "How does a virus spread its payload to harm a computer?",
            options: ["Through physical contact", "By hiding in programs", "Via email attachments", "Through voice commands"],
            answer: "By hiding in programs"
        },
        {
            question: "What distinguishes a worm from a virus?",
            options: ["Worms only spread through emails", "Worms spread through networks", "Worms always encrypt files", "Viruses are harder to detect"],
            answer: "Worms spread through networks"
        },
        {
            question: "What is a Trojan in the context of malware?",
            options: ["A type of worm", "Malware disguised as harmless software", "A computer security protocol", "A type of virus"],
            answer: "Malware disguised as harmless software"
        },
        {
            question: "What is the purpose of adware?",
            options: ["Encrypting files", "Collecting user information for targeted ads", "Spreading through networks", "Activating logic bombs"],
            answer: "Collecting user information for targeted ads"
        },
        {
            question: "Which malware type is known for running with the highest level of privileges and hiding deep within a system?",
            options: ["Logic Bomb", "Spyware", "Rootkit", "Dropper"],
            answer: "Rootkit"
        },
        {
            question: "What does ransomware do to data and resources?",
            options: ["Encrypts and holds them for ransom", "Deletes them permanently", "Shares them with third parties", "Modifies system settings"],
            answer: "Encrypts and holds them for ransom"
        },
        {
            question: "What is the primary function of a keylogger?",
            options: ["Encrypting files", "Spreading through networks", "Detecting pressed buttons and computer activity", "Collecting user information for ads"],
            answer: "Detecting pressed buttons and computer activity"
        },
        {
            question: "Which type of malware is a subset of a Trojan and installs additional malware?",
            options: ["Adware", "Dropper", "Worm", "Ransomware"],
            answer: "Dropper"
        },
        {
            question: "What does a logic bomb do?",
            options: ["Encrypts files", "Hidden Threat that activates based on certain conditions", "Collects user information for ads", "Spreads through networks"],
            answer: "Hidden Threat that activates based on certain conditions"
        },
        {
            question: "True or False: Adware collects user information and uses it to promote targeted advertisements.",
            options: ["True", "False"],
            answer: "True"
        },
        {
            question: "True or False: A virus becomes an inseparable part of a computer's code.",
            options: ["True", "False"],
            answer: "True"
        },
        {
            question: "True or False: Worms are easier to detect than viruses.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Keyloggers compromise the privacy of a clipboard.",
            options: ["True", "False"],
            answer: "True"
        },
        {
            question: "True or False: Behaviour-based detection looks for known virus signatures.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: False positives in virus detection negatively affect availability.",
            options: ["True", "False"],
            answer: "True"
        },
        {
            question: "True or False: Spyware is frequently tied in with genuine software.",
            options: ["True", "False"],
            answer: "True"
        },
        {
            question: "Which aspect of security does a false negative primarily impact negatively?",
            options: ["Availability", "Confidentiality", "Integrity", "Both A and C"],
            answer: "Both A and C"
        },
        {
            question: "Which malware type is known for spreading with minimal user engagement through a network?",
            options: ["Virus", "Worm", "Trojan", "Adware"],
            answer: "Worm"
        },
        {
            question: "What is the primary purpose of a dropper?",
            options: ["Spreading through networks", "Encrypting files", "Installing another malware", "Detecting pressed buttons"],
            answer: "Installing another malware"
        },
        {
            question: "Which detection method relies on maintaining a list of known viruses and their characteristics?",
            options: ["Signature-based detection", "Behavior-based detection", "Machine learning detection", "False positive detection"],
            answer: "Signature-based detection"
        },
        {
            question: "What does ransomware hold as ransom against the user?",
            options: ["User information", "System settings", "Data and resources", "Files with a database"],
            answer: "Data and resources"
        },
        {
            question: "Can Keylogger use its primary function to access passwords?",
            options: ["True", "False"],
            answer: "True"
        },
        {
            question: "What is the primary characteristic of behaviour-based detection?",
            options: ["Looking for known virus signatures", "Analysing payload effects and system changes", "Installing additional malware", "Activating based on certain conditions"],
            answer: "Analysing payload effects and system changes"
        },
        {
            question: "What is the main issue with signature-based detection?",
            options: ["Works only on known viruses", "Requires minimal user engagement", "Is resistant to false positives", "Depends on machine learning algorithms"],
            answer: "Works only on known viruses"
        },
        {
            question: "True or False: A dropper installs additional malware but cannot be redownloaded.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Rootkits are primarily spread through email attachments.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Behaviour-based detection relies on analysing known virus signatures.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Keyloggers cannot compromise the privacy of a clipboard.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "Are Pop-up ads a form of adware?",
            options: ["True", "False"],
            answer: "True"
        },
        {
            question: "Which type of malware is known for running as a hypervisor or firmware?",
            options: ["Logic Bomb", "Adware", "Rootkit", "Keylogger"],
            answer: "Rootkit"
        },
        {
            question: "What is the primary characteristic of false positives in virus detection?",
            options: ["Affects confidentiality negatively", "Affects availability negatively", "Affects integrity negatively", "Affects all aspects equally"],
            answer: "Affects availability negatively"
        },
        {
            question: "What is the main challenge of false negatives in virus detection?",
            options: ["Affects confidentiality negatively", "Affects availability negatively", "Affects integrity negatively", "Allows actual viruses to go undetected"],
            answer: "Allows actual viruses to go undetected"
        },
        {
            question: "What is the primary characteristic of machine learning detection in virus detection?",
            options: ["Analyzing known virus signatures", "Looking for suspicious patterns of behavior", "Maintaining a list of known viruses", "Activating based on certain conditions"],
            answer: "Looking for suspicious patterns of behavior"
        },
        {
            question: "True or False: Worms spread through networks with maximal user engagement.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Logic bombs always give a warning to the user before activating.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Adware primarily restricts data and resources on a computer.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Rootkits are easily removable from a system.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Ransomware is known for modifying system settings.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Keyloggers compromise the privacy of a clipboard.",
            options: ["True", "False"],
            answer: "True"
        },
        {
            question: "True or False: Signature-based detection relies on analyzing suspicious patterns of behavior.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: False positives negatively affect confidentiality.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Spyware is often independent and not tied to genuine software.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "What is the primary challenge with signature-based virus detection?",
            options: ["Works only on known viruses", "Requires maximal user engagement", "Is resistant to false positives", "Depends on machine learning algorithms"],
            answer: "Works only on known viruses"
        },
        {
            question: "What does the term 'false negative' in virus detection refer to?",
            options: ["Declaring an innocent program as a virus", "Declaring a virus as innocent", "Both A and B", "Neither A nor B"],
            answer: "Declaring a virus as innocent"
        },
        {
            question: "True or False: Viruses can spread through networks without any user interaction.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Adware primarily aims to activate logic bombs on the user's computer.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Polymorphic viruses modify themselves to look the same, making them easily detectable.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Spyware is always tied to genuine software, making it easily identifiable.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Rootkits can only run as hypervisors, not as firmware.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Keyloggers are primarily used to compromise the privacy of a computer's webcam.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "What is the primary characteristic of polymorphic viruses?",
            options: ["They modify themselves to look different", "They encrypt files with a database", "They activate based on certain conditions", "They spread through networks with maximal user engagement"],
            answer: "They modify themselves to look different"
        },
        {
            question: "What is the main issue with relying solely on signature-based detection?",
            options: ["Resistance to false positives", "Vulnerability to polymorphic viruses", "High efficiency with unknown viruses", "Low dependency on machine learning algorithms"],
            answer: "Vulnerability to polymorphic viruses"
        },
        {
            question: "Which malware type is likely to be resistant to false positives in detection?",
            options: ["Logic Bomb", "Worm", "Trojan", "Ransomware"],
            answer: "Logic Bomb"
        },
        {
            question: "What is the primary characteristic of false positives in virus detection?",
            options: ["Affects confidentiality negatively", "Affects availability negatively", "Affects integrity negatively", "Triggers unnecessary warnings for innocent programs"],
            answer: "Triggers unnecessary warnings for innocent programs"
        },
        {
            question: "Which malware type is known for spreading with maximal user engagement?",
            options: ["Virus", "Worm", "Trojan", "Adware"],
            answer: "Virus"
        },
        {
            question: "True or False: Adware can compromise the privacy of a computer's webcam.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Behaviour-based detection relies solely on known virus signatures.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: Machine learning detection relies on analysing known virus signatures.",
            options: ["True", "False"],
            answer: "False"
        },
        {
            question: "True or False: A false positive primarily affects the availability of the system.",
            options: ["True", "False"],
            answer: "True"
        },
        {
            question: "Which detection method relies on maintaining a list of known viruses and their characteristics?",
            options: ["Signature-based detection", "Behavior-based detection", "Machine learning detection", "False positive detection"],
            answer: "Signature-based detection"
        },
        {
            question: "True or False: Worms can spread through networks without any hidden payload.",
            options: ["True", "False"],
            answer: "False"
        }
    ];

    let randomQuestions = [];

    function getRandomQuestions(arr, num){
        const shuffled = [...arr].sort(() => 0.5 - Math.random());
        return shuffled.slice(0, num);
    }

    function loadQuestions() {
        const quizContainer = document.getElementById('quiz-container');
        randomQuestions = getRandomQuestions(questions, 20);
        quizContainer.innerHTML = '';
        randomQuestions.forEach((question, index) => {
            const questionElement = document.createElement('div');
            questionElement.classList.add('question');

            const questionText = document.createElement('p');
            questionText.innerText = `${index + 1}. ${question.question}`;
            questionElement.appendChild(questionText);

            if (question.options) {
                const optionsContainer = document.createElement('div');
                optionsContainer.classList.add('options');
                question.options.forEach(option => {
                    const label = document.createElement('label');
                    const input = document.createElement('input');
                    input.setAttribute('type', 'radio');
                    input.setAttribute('name', `question${index}`);
                    input.setAttribute('value', option);
                    label.appendChild(input);
                    label.appendChild(document.createTextNode(option));
                    optionsContainer.appendChild(label);
                });
                questionElement.appendChild(optionsContainer);
            } else {
                const trueOption = document.createElement('label');
                const trueInput = document.createElement('input');
                trueInput.setAttribute('type', 'radio');
                trueInput.setAttribute('name', `question${index}`);
                trueInput.setAttribute('value', 'True');
                trueOption.appendChild(trueInput);
                trueOption.appendChild(document.createTextNode('True'));
                
                const falseOption = document.createElement('label');
                const falseInput = document.createElement('input');
                falseInput.setAttribute('type', 'radio');
                falseInput.setAttribute('name', `question${index}`);
                falseInput.setAttribute('value', 'False');
                falseOption.appendChild(falseInput);
                falseOption.appendChild(document.createTextNode('False'));

                const optionsContainer = document.createElement('div');
                optionsContainer.classList.add('options');
                optionsContainer.appendChild(trueOption);
                optionsContainer.appendChild(falseOption);
                questionElement.appendChild(optionsContainer);
            }

            quizContainer.appendChild(questionElement);
        });
    }

    function submitQuiz() {
        const quizContainer = document.getElementById('quiz-container');
        const questionElements = quizContainer.getElementsByClassName('question');
        let score = 0;
        let wrongAnswers = [];
    
        for (let i = 0; i < questionElements.length; i++) {
            const questionElement = questionElements[i];
            const options = questionElement.getElementsByClassName('options')[0];
            const selectedOption = options.querySelector('input:checked');
            if (selectedOption && selectedOption.value === randomQuestions[i].answer) {
                score++;
            } else {
                wrongAnswers.push(i);
            }
        }

        const detailedResults = randomQuestions.map((question, index) => ({
            question: question.question,
            userAnswer: questionElements[index].querySelector('input:checked') ? questionElements[index].querySelector('input:checked').value : 'No answer',
            correctAnswer: question.answer,
            correct: !wrongAnswers.includes(index)
        }));
    
        localStorage.setItem('quizResults', JSON.stringify({ score, detailedResults }));
        window.location.href = 'results.html';
    }

    document.getElementById('submit-quiz').addEventListener('click', function(event) {
        event.preventDefault();
        submitQuiz();
    });

    loadQuestions();
});